<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="styles.css">
</head>

<staticContent>
    <mimeMap fileExtension=".json" mimeType="application/json" />
</staticContent>

<body onload="buildLists()">

<h1 id="pageTitle">MTG Randomizer</h1>
<div id="outer">
    <div id="columnL">
        <input type="text" id="myInput" onkeyup="searchNonXList()" placeholder="Search for names..">
        <ul id="keywordsList">
            <!--<li>
                <div onclick="randomize()" id="elementWrapper">
                    <div id="keyword">Hello</div>
                    <div id="randomize">
                        <div>Randomize</div>
                        <img id="randoArrow" src="Icons/right-arrow.png">
                    </div>
                </div>
            </li>-->
        </ul>
    </div>
    <div id="columnR">
        <ul id="randomizedKeywordsList">
            <li>
                <div id="elementWrapperR">
                    <div id="keyword">Hello</div>
                    <img id="randoArrow" src="Icons/right-arrow.png">
                    <div id="randoKeyword">Hello Again</div>
                </div>
            </li>
        </ul>
    </div>
</div>

<footer class="footer">
    <div class="container">
        <p>Attributions:</p>
        <ul>
            <li><a href="https://www.flaticon.com/free-icon/right-arrow_545682 ">Right Arrow by Freepik</a></li>
        </ul>
    </div>
</footer>

</body>

<script>
    function buildLists() {
        fetch("NonXKeywords.json")
        .then(response => response.json())
        .then(json => {
            json.keywords.forEach(element => {
                var li = document.getElementById("keywordsList").appendChild(document.createElement("li"));

                var elementWrapper = li.appendChild(document.createElement("div"));
                elementWrapper.id = "elementWrapper";
                elementWrapper.onclick = () => randomizeNonX(li);

                var keywordElement = elementWrapper.appendChild(document.createElement("div"));
                keywordElement.id = "keyword";
                keywordElement.appendChild(document.createTextNode(element));

                var randomize = elementWrapper.appendChild(document.createElement("div"));
                randomize.id = "randomize";
                randomize.appendChild(document.createElement("div")).appendChild(document.createTextNode("Randomize"));
                
                var img = randomize.appendChild(document.createElement("img"));
                img.src = "Icons/right-arrow.png";
                img.id = "randoArrow";

                li.style.display = "none";
            });
        });
    }

    function searchNonXList() {
      // Declare variables
      var input, filter, ul, li, a, i, txtValue;
      input = document.getElementById('myInput');
      filter = input.value.toUpperCase();
      ul = document.getElementById("keywordsList");
      li = ul.getElementsByTagName('li');
    
      // Loop through all list items, and hide those who don't match the search query
      if (filter != "") {
        for (i = 0; i < li.length; i++) {
            keyword = li[i].querySelector("#keyword");
            txtValue = keyword.textContent || keyword.innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
            li[i].style.display = "";
            } else {
            li[i].style.display = "none";
            }
        }
      } else {
        for (i = 0; i < li.length; i++) {
            li[i].style.display = "none";
        }
      }
    }

    function randomizeNonX(listElement) {
        ul = document.getElementById("keywordsList");
        li = ul.getElementsByTagName('li');

        var flag = false;

        while (!flag) {
            var select  = Math.random(li.length - 1);

            var keyword = listElement[select].querySelector("#keyword").textContent || listElement[select].querySelector("#keyword").innerText;
            var keywordCur = li[select].querySelector("#keyword").textContent || li[select].querySelector("#keyword").innerText;

            if(keyword !== keywordCur) {
                flag = true;



                listElement.remove();
            }
        }
    }
    </script>

</html>